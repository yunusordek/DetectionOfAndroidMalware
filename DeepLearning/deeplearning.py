

# Code to read csv file into Colaboratory:
!pip install -U -q PyDrive
from pydrive.auth import GoogleAuth
from pydrive.drive import GoogleDrive
from google.colab import auth
from oauth2client.client import GoogleCredentials
# Authenticate and create the PyDrive client.
auth.authenticate_user()
gauth = GoogleAuth()
gauth.credentials = GoogleCredentials.get_application_default()
drive = GoogleDrive(gauth)

auth.authenticate_user()
gauth = GoogleAuth()
gauth.credentials = GoogleCredentials.get_application_default()                       
drive = GoogleDrive(gauth)

link="Your google drive csv location link"
fluff, id = link.split('=')

import pandas as pd 
downloaded = drive.CreateFile({'id':id}) 
downloaded.GetContentFile('new_all.csv')  
data = pd.read_csv('new_all.csv')

import scipy as sp
from sklearn.preprocessing import MinMaxScaler
from sklearn.model_selection import train_test_split
from keras.preprocessing import sequence
import numpy as np

x=data.iloc[:,0:82]
y=data.iloc[:,82:83]
x=x.values
y=y.values

x_eğitim, x_test,y_eğitim, y_test = train_test_split(x, y, test_size = 0.2, random_state = 0)

from keras.layers import Dense, Embedding, Flatten, SimpleRNN
from keras.models import Sequential
from keras.layers import Conv1D, GlobalAveragePooling1D, MaxPooling1D
from keras.layers import GlobalMaxPooling1D
from keras.layers import Dense, Dropout, Activation
from keras.optimizers import SGD
import matplotlib.pyplot as plt

model = Sequential()
model.add(Dense(64, input_dim=82, activation='relu'))
model.add(Dropout(0.5))
model.add(Dense(64, activation='relu'))
model.add(Dropout(0.5))
model.add(Dense(1, activation='sigmoid'))

model.compile(loss='binary_crossentropy',
              optimizer='adam',
              metrics=['accuracy'])

history=model.fit(x_eğitim, y_eğitim,
          epochs=50,
          batch_size=128)

plt.plot(history.history['acc'])

plt.title('Model Doğruluğu')
plt.ylabel('Doğruluk')
plt.xlabel('Epoch')
plt.legend(['Train', 'Test'], loc='upper left')
plt.show()

# Plot training & validation loss values
plt.plot(history.history['loss'])
plt.title('Model Kaybı')
plt.ylabel('Kayıp')
plt.xlabel('Epoch')
plt.legend(['Train', 'Test'], loc='upper left')
plt.show()

print(history.history.keys())

model.save('model.h5')
model_file = drive.CreateFile({'title' : 'model.h5'})                       
model_file.SetContentFile('model.h5')                       
model_file.Upload()

# download to google drive                       
drive.CreateFile({'id': model_file.get('id')})

file_obj = drive.CreateFile({'id':'1vN95UXo6_kYMf0b8SWBsel3JeBSVHQMN'})
file_obj.GetContentFile('model.h5')